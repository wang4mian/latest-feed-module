---
import DashboardLayout from '../layouts/DashboardLayout.astro';
import { getArticles } from '../lib/supabase';

// è·å–URLå‚æ•°
const url = Astro.url;
const category = url.searchParams.get('category') || '';
const source = url.searchParams.get('source') || '';
const search = url.searchParams.get('search') || '';
const sort = url.searchParams.get('sort') || 'ai_score_desc';
const page = parseInt(url.searchParams.get('page') || '1');
const limit = 20;
const offset = (page - 1) * limit;

// æ„å»ºç­›é€‰æ¡ä»¶
const filters: any = { limit, offset };
if (category) filters.category = category;
if (source) filters.source = source;
if (search) filters.search = search;
if (sort) filters.sort = sort;

// åˆå§‹åŒ–å˜é‡
let articles: any[] = [];
let error: any = null;
let count: number = 0;
let totalPages: number = 1;
let hasArticles: boolean = false;

try {
  const response = await getArticles(filters);
  articles = response.data || [];
  error = response.error;
  count = response.count || 0;
  
  totalPages = count ? Math.ceil(count / limit) : 1;
  hasArticles = articles && articles.length > 0;

  // è°ƒè¯•ä¿¡æ¯
  console.log('æ–‡ç« æ±  - æ•°æ®æŸ¥è¯¢ç»“æœ:', {
    filters,
    count: articles.length,
    error: error,
    totalCount: count,
    hasArticles,
    sampleArticle: articles[0] || null
  });

} catch (err) {
  console.error('é¡µé¢åŠ è½½é”™è¯¯:', err);
  error = err;
}

// æ ¼å¼åŒ–æ—¥æœŸ
const formatDate = (dateString: string) => {
  return new Date(dateString).toLocaleDateString('zh-CN', {
    month: 'short', 
    day: 'numeric',
    hour: '2-digit',
    minute: '2-digit'
  });
};

// è·å–è¯„åˆ†å¾½ç« æ ·å¼ç±»
const getScoreBadgeClass = (score: number) => {
  if (score >= 80) return 'high';    // ç»¿è‰²
  if (score >= 60) return 'medium';  // é»„è‰²
  return 'low';                      // ç°è‰²
};

// åˆ†ç±»æ˜¾ç¤º
const getCategoryText = (category: string) => {
  const categoryMap: { [key: string]: string } = {
    'Core Equipment': 'æ ¸å¿ƒè®¾å¤‡',
    'Supply Chain': 'ä¾›åº”é“¾',
    'Market Trends': 'å¸‚åœºè¶‹åŠ¿',
    'Technological Innovation': 'æŠ€æœ¯åˆ›æ–°',
    'Business Models': 'å•†ä¸šæ¨¡å¼'
  };
  return categoryMap[category] || category || 'æœªåˆ†ç±»';
};

// è·å–åˆ†ç±»æ ·å¼ç±»
const getCategoryClass = (category: string) => {
  const classMap: { [key: string]: string } = {
    'Core Equipment': 'equipment',
    'Supply Chain': 'supply',
    'Market Trends': 'trends', 
    'Technological Innovation': 'innovation',
    'Business Models': 'business'
  };
  return classMap[category] || 'default';
};

// çŠ¶æ€æ˜¾ç¤º
const getStatusText = (status: string) => {
  const statusMap: { [key: string]: string } = {
    'pending': 'å¾…å¤„ç†',
    'adopted': 'å·²é€šè¿‡',
    'archived': 'å·²å½’æ¡£', 
    'ignored': 'å·²å¿½ç•¥',
    'draft': 'è‰ç¨¿'
  };
  return statusMap[status] || status;
};
---

<DashboardLayout title="æ–‡ç« æ±  - åˆ¶é€ ä¸šæƒ…æŠ¥ç³»ç»Ÿ">
  <div class="uk-container">
    <!-- é¡µé¢æ ‡é¢˜ -->
    <div class="uk-text-center uk-margin-bottom">
      <h1 class="uk-heading-medium uk-margin-remove">æ–‡ç« æ± </h1>
    </div>

    <!-- ç­›é€‰æ  - çª„çª„çš„ä¸€æ¨ªæºœ -->
    <div class="filter-bar uk-background-muted uk-padding-small uk-margin-bottom">
      <div class="uk-flex uk-flex-middle uk-flex-wrap uk-grid-small" uk-grid>
        <!-- æœç´¢æ¡† -->
        <div>
          <form class="uk-search uk-search-small">
            <span class="uk-form-icon" uk-icon="search"></span>
            <input class="uk-search-input" type="search" name="search" value={search} placeholder="æœç´¢æ ‡é¢˜">
          </form>
        </div>
        
        <!-- åˆ†ç±»ç­›é€‰ -->
        <div>
          <select class="uk-select uk-form-small" name="category" onchange="filterChange()">
            <option value="">å…¨éƒ¨åˆ†ç±»</option>
            <option value="Core Equipment" {category === 'Core Equipment' ? 'selected' : ''}>æ ¸å¿ƒè®¾å¤‡</option>
            <option value="Supply Chain" {category === 'Supply Chain' ? 'selected' : ''}>ä¾›åº”é“¾</option>
            <option value="Market Trends" {category === 'Market Trends' ? 'selected' : ''}>å¸‚åœºè¶‹åŠ¿</option>
            <option value="Technological Innovation" {category === 'Technological Innovation' ? 'selected' : ''}>æŠ€æœ¯åˆ›æ–°</option>
            <option value="Business Models" {category === 'Business Models' ? 'selected' : ''}>å•†ä¸šæ¨¡å¼</option>
          </select>
        </div>
        
        <!-- çŠ¶æ€ç­›é€‰ -->
        <div>
          <select class="uk-select uk-form-small" name="status" onchange="filterChange()">
            <option value="">å…¨éƒ¨çŠ¶æ€</option>
            <option value="pending">å¾…å¤„ç†</option>
            <option value="adopted">å·²é€šè¿‡</option>
            <option value="archived">å·²å½’æ¡£</option>
            <option value="ignored">å·²å¿½ç•¥</option>
          </select>
        </div>
        
        <!-- æ’åº -->
        <div>
          <select class="uk-select uk-form-small" name="sort" onchange="filterChange()">
            <option value="ai_score_desc" {sort === 'ai_score_desc' ? 'selected' : ''}>AIè¯„åˆ†â†“</option>
            <option value="ai_score_asc" {sort === 'ai_score_asc' ? 'selected' : ''}>AIè¯„åˆ†â†‘</option>
            <option value="created_at_desc" {sort === 'created_at_desc' ? 'selected' : ''}>å‘å¸ƒæ—¥æœŸâ†“</option>
            <option value="created_at_asc" {sort === 'created_at_asc' ? 'selected' : ''}>å‘å¸ƒæ—¥æœŸâ†‘</option>
          </select>
        </div>
        
        <!-- ç»Ÿè®¡ä¿¡æ¯ -->
        <div class="uk-width-expand uk-text-right">
          <span class="uk-text-small uk-text-muted">
            å…± <strong>{count}</strong> ç¯‡ â€¢ ç¬¬ <strong>{page}</strong>/{totalPages} é¡µ
          </span>
        </div>
      </div>
    </div>


    <!-- æ–‡ç« æ‘˜è¦å¡ç‰‡åˆ—è¡¨ -->
    {hasArticles ? (
      <div class="article-pool">
        {articles.map((article: any) => (
          <div class="summary-card uk-card uk-card-default uk-card-small uk-margin-small" data-article-id={article.id}>
              <div class="uk-card-body uk-padding-small">
                <div class="uk-grid uk-grid-small" uk-grid>
                  <!-- AIè¯„åˆ†åŒºåŸŸ -->
                  <div class="uk-width-auto">
                    <div class={`score-badge score-${getScoreBadgeClass(article.ai_score || 0)}`}>
                      <div class="score-number">{article.ai_score || 0}</div>
                    </div>
                  </div>
                  
                  <!-- æ–‡ç« å†…å®¹ -->
                  <div class="uk-width-expand">
                    <h3 class="uk-card-title uk-margin-small-bottom">
                      <a href={article.link} target="_blank" class="uk-link-reset">{article.title}</a>
                    </h3>
                    
                    <!-- å…ƒä¿¡æ¯æ¡ -->
                    <div class="meta-line uk-text-small uk-text-muted uk-margin-small-top">
                      <span class="source-name">{article.rss_sources?.name || 'æœªçŸ¥æ¥æº'}</span>
                      <span class="separator">â€¢</span>
                      <span class={`category-badge category-${getCategoryClass(article.ai_category)}`}>
                        {getCategoryText(article.ai_category || '')}
                      </span>
                      <span class="separator">â€¢</span>
                      <span class={`status-badge status-${article.overall_status || 'pending'}`}>
                        {getStatusText(article.overall_status || 'pending')}
                      </span>
                    </div>
                    
                    {article.ai_summary && (
                      <p class="uk-text-small uk-margin-small-bottom">
                        {article.ai_summary.split('\n').slice(0, 2).join('\n')}
                        {article.ai_summary.split('\n').length > 2 && '...'}
                      </p>
                    )}
                  </div>
                  
                  <!-- æ“ä½œæŒ‰é’®åŒºåŸŸ -->
                  <div class="uk-width-auto">
                    <div class="action-buttons uk-flex uk-flex-middle">
                      <!-- æ ¸å¿ƒæ“ä½œæŒ‰é’® -->
                      <div class="uk-button-group uk-margin-small-right">
                        <button class="uk-button uk-button-success uk-button-small" 
                                data-action="adopt" data-id={article.id} title="é€šè¿‡">
                          âœ…
                        </button>
                        <button class="uk-button uk-button-default uk-button-small" 
                                data-action="archive" data-id={article.id} title="å½’æ¡£">
                          ğŸ—„ï¸
                        </button>
                        <button class="uk-button uk-button-danger uk-button-small" 
                                data-action="ignore" data-id={article.id} title="å¿½ç•¥">
                          âŒ
                        </button>
                      </div>
                      
                      <!-- è¯¦æƒ…å±•å¼€æŒ‰é’® -->
                      <button class="uk-button uk-button-text uk-button-small expand-details" 
                              data-id={article.id} title="æŸ¥çœ‹è¯¦æƒ…">
                        ğŸ“–
                      </button>
                    </div>
                  </div>
                </div>
              </div>
              
              <!-- è¯¦æƒ…åŒºåŸŸ (é»˜è®¤éšè—ï¼Œç‚¹å‡»å±•å¼€) -->
              <div class="article-details uk-hidden" data-id={article.id}>
                <div class="uk-card-body uk-padding-small uk-background-muted">
                  <!-- è¯¦æƒ…å†…å®¹å°†é€šè¿‡JavaScriptåŠ¨æ€åŠ è½½ -->
                  <div class="details-loading uk-text-center uk-text-muted">
                    <div uk-spinner class="uk-margin-small-right"></div>
                    åŠ è½½è¯¦ç»†ä¿¡æ¯ä¸­...
                  </div>
                </div>
              </div>
              
            </div>
          </div>
        ))}
      </div>
    ) : (
      <div class="uk-text-center uk-padding-large">
        <h3 class="uk-text-muted">æš‚æ— æ–‡ç« </h3>
        <p class="uk-text-muted">è¿˜æ²¡æœ‰æ–‡ç« æ•°æ®ï¼Œè¯·ç­‰å¾…ç³»ç»Ÿè‡ªåŠ¨æŠ“å–</p>
      </div>
    )}

    <!-- ç®€å•åˆ†é¡µ -->
    {totalPages > 1 && (
      <div class="uk-flex uk-flex-center uk-margin-top">
        <ul class="uk-pagination">
          {page > 1 && <li><a href={`?page=${page - 1}&category=${category}&sort=${sort}&search=${search}`}>ä¸Šä¸€é¡µ</a></li>}
          <li><span>{page} / {totalPages}</span></li>
          {page < totalPages && <li><a href={`?page=${page + 1}&category=${category}&sort=${sort}&search=${search}`}>ä¸‹ä¸€é¡µ</a></li>}
        </ul>
      </div>
    )}
  </div>
</DashboardLayout>

<script>
  // ç­›é€‰å˜æ›´å‡½æ•°
  function filterChange() {
    const searchInput = document.querySelector('input[name="search"]') as HTMLInputElement;
    const categorySelect = document.querySelector('select[name="category"]') as HTMLSelectElement;
    const statusSelect = document.querySelector('select[name="status"]') as HTMLSelectElement;
    const sortSelect = document.querySelector('select[name="sort"]') as HTMLSelectElement;
    
    const params = new URLSearchParams();
    if (searchInput?.value?.trim()) params.set('search', searchInput.value.trim());
    if (categorySelect?.value) params.set('category', categorySelect.value);
    if (statusSelect?.value) params.set('status', statusSelect.value);
    if (sortSelect?.value) params.set('sort', sortSelect.value);
    
    window.location.href = `${window.location.pathname}?${params.toString()}`;
  }
  
  // åˆ‡æ¢è¯¦æƒ…å±•å¼€/æ”¶èµ·
  async function toggleArticleDetails(articleId: string) {
    const detailsDiv = document.querySelector(`.article-details[data-id="${articleId}"]`);
    const expandBtn = document.querySelector(`.expand-details[data-id="${articleId}"]`);
    
    if (!detailsDiv || !expandBtn) return;
    
    if (detailsDiv.classList.contains('uk-hidden')) {
      // å±•å¼€è¯¦æƒ…
      detailsDiv.classList.remove('uk-hidden');
      expandBtn.textContent = 'ğŸ“–';
      expandBtn.setAttribute('title', 'æ”¶èµ·è¯¦æƒ…');
      
      // æ¨¡æ‹ŸåŠ è½½è¯¦ç»†ä¿¡æ¯
      setTimeout(() => {
        const loadingDiv = detailsDiv.querySelector('.details-loading');
        if (loadingDiv) {
          loadingDiv.innerHTML = `
            <div class="uk-grid uk-grid-small" uk-grid>
              <div class="uk-width-1-2">
                <h5 class="uk-heading-bullet">AIæ‘˜è¦</h5>
                <p class="uk-text-small">è¿™é‡Œæ˜¾ç¤ºAIç”Ÿæˆçš„è¯¦ç»†æ‘˜è¦å†…å®¹...</p>
              </div>
              <div class="uk-width-1-2">
                <h5 class="uk-heading-bullet">æˆ˜ç•¥æ„ä¹‰</h5>
                <p class="uk-text-small">è¿™é‡Œæ˜¾ç¤ºæˆ˜ç•¥æ„ä¹‰åˆ†æ...</p>
              </div>
              <div class="uk-width-1-1">
                <h5 class="uk-heading-bullet">å…³é”®å®ä½“</h5>
                <div>
                  <span class="uk-label uk-margin-small-right">å®ä½“1</span>
                  <span class="uk-label uk-margin-small-right">å®ä½“2</span>
                  <span class="uk-label uk-margin-small-right">å®ä½“3</span>
                </div>
              </div>
              <div class="uk-width-1-1 uk-text-right uk-margin-small-top">
                <a href="#" class="uk-button uk-button-text uk-button-small">æŸ¥çœ‹åŸæ–‡ â†—</a>
              </div>
            </div>
          `;
        }
      }, 800);
    } else {
      // æ”¶èµ·è¯¦æƒ…
      detailsDiv.classList.add('uk-hidden');
      expandBtn.textContent = 'ğŸ“–';
      expandBtn.setAttribute('title', 'æŸ¥çœ‹è¯¦æƒ…');
    }
  }
  
  // JavaScriptç‰ˆæœ¬çš„çŠ¶æ€æ˜¾ç¤ºå‡½æ•°
  function getStatusText(status: string) {
    const statusMap: { [key: string]: string } = {
      'pending': 'å¾…å¤„ç†',
      'adopted': 'å·²é€šè¿‡',
      'archived': 'å·²å½’æ¡£', 
      'ignored': 'å·²å¿½ç•¥',
      'draft': 'è‰ç¨¿'
    };
    return statusMap[status] || status;
  }
  
  // æ‰§è¡Œæ–‡ç« æ“ä½œ
  async function executeArticleAction(action: string, articleId: string) {
    console.log(`æ‰§è¡Œæ“ä½œ: ${action}, æ–‡ç« ID: ${articleId}`);
    
    const button = document.querySelector(`[data-action="${action}"][data-id="${articleId}"]`);
    if (!button) return;
    
    const originalText = button.textContent;
    button.setAttribute('disabled', 'true');
    button.textContent = 'â³';
    
    // æ˜ å°„æ“ä½œåˆ°çŠ¶æ€ (ä¸´æ—¶è§£å†³æ–¹æ¡ˆ)
    const statusMap: { [key: string]: string } = {
      'adopt': 'ready_for_review', // ä¸´æ—¶ä½¿ç”¨ ready_for_review ä»£æ›¿ adopted
      'archive': 'draft',          // ä¸´æ—¶ä½¿ç”¨ draft ä»£æ›¿ archived
      'ignore': 'draft'            // ä¸´æ—¶ä½¿ç”¨ draft ä»£æ›¿ ignored
    };
    
    const newStatus = statusMap[action];
    if (!newStatus) {
      console.error('æœªçŸ¥æ“ä½œ:', action);
      return;
    }
    
    try {
      // è°ƒç”¨çœŸå® API æ›´æ–°çŠ¶æ€
      const response = await fetch(`/api/articles/${articleId}/status`, {
        method: 'PATCH',
        headers: {
          'Content-Type': 'application/json',
        },
        body: JSON.stringify({ status: newStatus })
      });
      
      if (!response.ok) {
        throw new Error(`HTTPé”™è¯¯: ${response.status}`);
      }
      
      const result = await response.json();
      
      if (result.success) {
        // æˆåŠŸæ›´æ–°
        button.textContent = action === 'adopt' ? 'âœ…' : action === 'archive' ? 'ğŸ—„ï¸' : 'âŒ';
        
        // æ›´æ–°å¡ç‰‡æ ·å¼è¡¨ç¤ºå·²å¤„ç†
        const card = button.closest('.summary-card');
        if (card) {
          card.classList.add(`processed-${action}`);
          card.style.opacity = '0.7';
          
          // æ›´æ–°çŠ¶æ€æ˜¾ç¤º
          const statusBadge = card.querySelector('.status-badge');
          if (statusBadge) {
            statusBadge.textContent = getStatusText(newStatus);
            statusBadge.className = `status-badge status-${newStatus}`;
          }
        }
        
        console.log('âœ… æ–‡ç« çŠ¶æ€æ›´æ–°æˆåŠŸ:', result.message);
        
        // æ˜¾ç¤ºæˆåŠŸé€šçŸ¥
        if (typeof UIkit !== 'undefined') {
          UIkit.notification({
            message: result.message,
            status: 'success',
            timeout: 2000
          });
        }
        
        // 2ç§’åæ¢å¤æŒ‰é’®
        setTimeout(() => {
          button.removeAttribute('disabled');
          button.textContent = originalText;
        }, 2000);
        
      } else {
        throw new Error(result.error || 'æ›´æ–°å¤±è´¥');
      }
      
    } catch (error) {
      console.error('âŒ æ›´æ–°æ–‡ç« çŠ¶æ€å¤±è´¥:', error);
      
      // æ¢å¤æŒ‰é’®çŠ¶æ€
      button.removeAttribute('disabled');
      button.textContent = originalText;
      
      // æ˜¾ç¤ºé”™è¯¯é€šçŸ¥
      if (typeof UIkit !== 'undefined') {
        UIkit.notification({
          message: 'æ›´æ–°å¤±è´¥: ' + error.message,
          status: 'danger',
          timeout: 4000
        });
      }
    }
  }
  
  // DOMåŠ è½½å®Œæˆåçš„åˆå§‹åŒ–
  document.addEventListener('DOMContentLoaded', function() {
    // æœç´¢è¡¨å•æäº¤
    const searchForm = document.querySelector('.uk-search');
    searchForm?.addEventListener('submit', function(e) {
      e.preventDefault();
      filterChange();
    });
    
    // äº‹ä»¶å§”æ‰˜å¤„ç†æ‰€æœ‰æŒ‰é’®ç‚¹å‡»
    document.addEventListener('click', function(e) {
      const target = e.target as HTMLElement;
      
      // æ“ä½œæŒ‰é’®
      if (target.hasAttribute('data-action')) {
        const action = target.getAttribute('data-action')!;
        const articleId = target.getAttribute('data-id')!;
        executeArticleAction(action, articleId);
      }
      
      // è¯¦æƒ…å±•å¼€æŒ‰é’®
      if (target.classList.contains('expand-details')) {
        const articleId = target.getAttribute('data-id')!;
        toggleArticleDetails(articleId);
      }
    });
  });
</script>
</DashboardLayout>

<style is:global>
  /* ===== æ–‡ç« æ± ä¸“ç”¨æ ·å¼ ===== */
  
  /* AIè¯„åˆ†å¾½ç«  - åŠ å¼ºç‰¹å¼‚æ€§ */
  .article-pool .score-badge {
    width: 60px !important;
    height: 60px !important;
    border-radius: 12px !important;
    display: flex !important;
    align-items: center !important;
    justify-content: center !important;
    font-weight: bold !important;
    color: white !important;
    position: relative !important;
    box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15) !important;
    border: 2px solid rgba(255, 255, 255, 0.2) !important;
  }
  
  .article-pool .score-badge.score-high {
    background: linear-gradient(135deg, #10b981, #059669) !important;
    box-shadow: 0 4px 16px rgba(16, 185, 129, 0.4) !important;
  }
  
  .article-pool .score-badge.score-medium {
    background: linear-gradient(135deg, #f59e0b, #d97706) !important;
    box-shadow: 0 4px 16px rgba(245, 158, 11, 0.4) !important;
  }
  
  .article-pool .score-badge.score-low {
    background: linear-gradient(135deg, #6b7280, #4b5563) !important;
    box-shadow: 0 4px 16px rgba(107, 114, 128, 0.4) !important;
  }
  
  .article-pool .score-number {
    font-size: 28px !important;
    line-height: 1 !important;
    font-weight: 900 !important;
    text-shadow: 0 1px 2px rgba(0, 0, 0, 0.2) !important;
  }
  
  /* å…ƒä¿¡æ¯æ¡ - å¢å¼ºæ ·å¼ */
  .article-pool .meta-line {
    display: flex !important;
    align-items: center !important;
    gap: 10px !important;
    flex-wrap: wrap !important;
    margin-top: 8px !important;
  }
  
  .article-pool .separator {
    color: #9ca3af !important;
    font-weight: bold !important;
    font-size: 14px !important;
  }
  
  .article-pool .source-name {
    font-weight: 600 !important;
    color: #374151 !important;
  }
  
  /* åˆ†ç±»å¾½ç«  - å¢å¼ºæ ·å¼ */
  .article-pool .category-badge {
    display: inline-block !important;
    padding: 4px 10px !important;
    border-radius: 16px !important;
    font-size: 11px !important;
    font-weight: 600 !important;
    text-transform: uppercase !important;
    letter-spacing: 0.5px !important;
    border: 1px solid rgba(0, 0, 0, 0.1) !important;
  }
  
  .article-pool .category-equipment { background: #f3e8ff !important; color: #7c3aed !important; border-color: #c4b5fd !important; }
  .article-pool .category-supply { background: #fef3c7 !important; color: #d97706 !important; border-color: #fcd34d !important; }
  .article-pool .category-trends { background: #dbeafe !important; color: #2563eb !important; border-color: #93c5fd !important; }
  .article-pool .category-innovation { background: #dcfce7 !important; color: #16a34a !important; border-color: #86efac !important; }
  .article-pool .category-business { background: #fce7f3 !important; color: #be185d !important; border-color: #f9a8d4 !important; }
  .article-pool .category-default { background: #f3f4f6 !important; color: #6b7280 !important; border-color: #d1d5db !important; }
  
  /* çŠ¶æ€å¾½ç«  - å¢å¼ºæ ·å¼ */
  .article-pool .status-badge {
    display: inline-block !important;
    padding: 4px 10px !important;
    border-radius: 16px !important;
    font-size: 11px !important;
    font-weight: 600 !important;
    border: 1px solid rgba(0, 0, 0, 0.1) !important;
  }
  
  .article-pool .status-pending { background: #dbeafe !important; color: #2563eb !important; border-color: #93c5fd !important; }
  .article-pool .status-adopted { background: #dcfce7 !important; color: #16a34a !important; border-color: #86efac !important; }
  .article-pool .status-archived { background: #f3f4f6 !important; color: #6b7280 !important; border-color: #d1d5db !important; }
  .article-pool .status-ignored { background: #fee2e2 !important; color: #dc2626 !important; border-color: #fca5a5 !important; }
  .article-pool .status-draft { background: #fef3c7 !important; color: #d97706 !important; border-color: #fcd34d !important; }
  
  /* æ‘˜è¦å¡ç‰‡ - å¢å¼ºæ ·å¼ */
  .article-pool .summary-card {
    transition: all 0.3s ease !important;
    border-left: 5px solid transparent !important;
    border-radius: 12px !important;
    box-shadow: 0 2px 8px rgba(0, 0, 0, 0.08) !important;
    overflow: hidden !important;
    background: #ffffff !important;
  }
  
  .article-pool .summary-card:hover {
    border-left-color: #3b82f6 !important;
    transform: translateX(4px) translateY(-2px) !important;
    box-shadow: 0 8px 24px rgba(59, 130, 246, 0.15) !important;
  }
  
  /* å·²å¤„ç†çš„å¡ç‰‡æ ·å¼ */
  .summary-card.processed-adopt {
    border-left-color: #10b981;
    background-color: #f0fdf4;
  }
  
  .summary-card.processed-archive {
    border-left-color: #6b7280;
    background-color: #f9fafb;
  }
  
  .summary-card.processed-ignore {
    border-left-color: #ef4444;
    background-color: #fef2f2;
  }
  
  /* æ“ä½œæŒ‰é’® - å¢å¼ºæ ·å¼ */
  .article-pool .action-buttons .uk-button {
    min-width: 38px !important;
    height: 38px !important;
    border-radius: 8px !important;
    font-size: 16px !important;
    transition: all 0.2s ease !important;
    border: 2px solid transparent !important;
    font-weight: 600 !important;
  }
  
  .article-pool .action-buttons .uk-button:hover {
    transform: scale(1.15) !important;
    box-shadow: 0 4px 12px rgba(0, 0, 0, 0.2) !important;
  }
  
  .article-pool .action-buttons .uk-button-success {
    background: linear-gradient(135deg, #10b981, #059669) !important;
    border-color: #059669 !important;
  }
  
  .article-pool .action-buttons .uk-button-danger {
    background: linear-gradient(135deg, #ef4444, #dc2626) !important;
    border-color: #dc2626 !important;
  }
  
  .article-pool .action-buttons .uk-button-default {
    background: linear-gradient(135deg, #f3f4f6, #e5e7eb) !important;
    color: #374151 !important;
    border-color: #d1d5db !important;
  }
  
  /* è¯¦æƒ…åŒºåŸŸ */
  .article-details {
    border-top: 1px solid #e5e7eb;
    animation: slideDown 0.3s ease;
  }
  
  @keyframes slideDown {
    from {
      opacity: 0;
      max-height: 0;
    }
    to {
      opacity: 1;
      max-height: 300px;
    }
  }
  
  
  @keyframes slideIn {
    from {
      opacity: 0;
      transform: translateY(-20px);
    }
    to {
      opacity: 1;
      transform: translateY(0);
    }
  }
  
  /* ç­›é€‰æ  - çª„çª„çš„ä¸€æ¨ªæºœ */
  .filter-bar {
    border-radius: 8px !important;
    border: 1px solid #e5e7eb !important;
    background: #f9fafb !important;
  }
  
  .filter-bar .uk-search-input {
    width: 200px !important;
    height: 32px !important;
  }
  
  .filter-bar .uk-select {
    height: 32px !important;
    min-width: 120px !important;
    font-size: 13px !important;
  }
  
  /* æ–‡ç« æ± å®¹å™¨ */
  .article-pool {
    max-width: none;
  }
  
  /* å“åº”å¼è°ƒæ•´ */
  @media (max-width: 768px) {
    .score-badge {
      width: 48px;
      height: 48px;
    }
    
    .score-number {
      font-size: 18px;
    }
    
    .meta-line {
      flex-direction: column;
      align-items: flex-start;
      gap: 4px;
    }
    
    .action-buttons {
      flex-direction: column;
      gap: 4px;
    }
  }
  
  /* åŠ è½½åŠ¨ç”»ä¼˜åŒ– */
  .details-loading {
    min-height: 80px;
    display: flex;
    align-items: center;
    justify-content: center;
  }
</style>